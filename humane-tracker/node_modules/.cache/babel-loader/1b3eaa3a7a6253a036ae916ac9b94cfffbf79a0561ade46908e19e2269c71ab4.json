{"ast":null,"code":"var _jsxFileName = \"/Users/idvorkin/gits/humane-tracker-1/humane-tracker/src/components/HabitTracker.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { HabitService } from '../services/habitService';\nimport { HabitManager } from './HabitManager';\nimport { InitializeHabits } from './InitializeHabits';\nimport { CleanupDuplicates } from './CleanupDuplicates';\nimport { DEFAULT_HABITS } from '../data/defaultHabits';\nimport { format, addDays, isYesterday, isToday } from 'date-fns';\nimport './HabitTracker.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst habitService = new HabitService();\nconst CATEGORIES = {\n  mobility: {\n    name: 'Movement & Mobility',\n    color: '#60a5fa'\n  },\n  connection: {\n    name: 'Connections',\n    color: '#a855f7'\n  },\n  balance: {\n    name: 'Inner Balance',\n    color: '#fbbf24'\n  },\n  joy: {\n    name: 'Joy & Play',\n    color: '#f472b6'\n  },\n  strength: {\n    name: 'Strength Building',\n    color: '#34d399'\n  }\n};\nexport const HabitTracker = ({\n  userId\n}) => {\n  _s();\n  const [habits, setHabits] = useState([]);\n  const [sections, setSections] = useState([]);\n  const [weekDates, setWeekDates] = useState([]);\n  const [showHabitManager, setShowHabitManager] = useState(false);\n  const [showInitializer, setShowInitializer] = useState(false);\n  const [showCleanup, setShowCleanup] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  const collapsedSectionsRef = useRef(new Set(['balance', 'joy']));\n  const useMockMode = !userId || userId === 'mock-user';\n  const [summaryStats, setSummaryStats] = useState({\n    dueToday: 0,\n    overdue: 0,\n    doneToday: 0,\n    onTrack: 0\n  });\n  useEffect(() => {\n    // Reset state when mode changes\n    setHabits([]);\n    setSections([]);\n\n    // Set up trailing 7 days (today and previous 6 days)\n    const today = new Date();\n    const dates = [];\n    for (let i = 6; i >= 0; i--) {\n      dates.push(addDays(today, -i));\n    }\n    setWeekDates(dates);\n\n    // Check if we should use mock mode\n    if (useMockMode) {\n      // Use mock data for testing with default habits and some sample entries  \n      const today = new Date();\n      const mockHabits = DEFAULT_HABITS.map((habit, index) => {\n        // Add some sample entries for demo\n        const entries = [];\n\n        // Add sample entries for some habits\n        if (habit.name === 'Back Twists') {\n          entries.push({\n            id: 'e1',\n            habitId: `mock-${index}`,\n            userId,\n            date: addDays(today, -6),\n            value: 2,\n            createdAt: new Date()\n          }, {\n            id: 'e2',\n            habitId: `mock-${index}`,\n            userId,\n            date: addDays(today, -5),\n            value: 4,\n            createdAt: new Date()\n          }, {\n            id: 'e3',\n            habitId: `mock-${index}`,\n            userId,\n            date: addDays(today, -4),\n            value: 4,\n            createdAt: new Date()\n          }, {\n            id: 'e4',\n            habitId: `mock-${index}`,\n            userId,\n            date: addDays(today, -3),\n            value: 4,\n            createdAt: new Date()\n          });\n        } else if (habit.name === 'Shin Boxes') {\n          entries.push({\n            id: 'e5',\n            habitId: `mock-${index}`,\n            userId,\n            date: addDays(today, -6),\n            value: 2,\n            createdAt: new Date()\n          }, {\n            id: 'e6',\n            habitId: `mock-${index}`,\n            userId,\n            date: addDays(today, -4),\n            value: 1,\n            createdAt: new Date()\n          }, {\n            id: 'e7',\n            habitId: `mock-${index}`,\n            userId,\n            date: addDays(today, -2),\n            value: 1,\n            createdAt: new Date()\n          });\n        } else if (habit.name === 'Juggling') {\n          entries.push({\n            id: 'e8',\n            habitId: `mock-${index}`,\n            userId,\n            date: addDays(today, -6),\n            value: 3,\n            createdAt: new Date()\n          }, {\n            id: 'e9',\n            habitId: `mock-${index}`,\n            userId,\n            date: addDays(today, -3),\n            value: 1,\n            createdAt: new Date()\n          });\n        } else if (habit.name === 'TGU 28KG') {\n          entries.push({\n            id: 'e10',\n            habitId: `mock-${index}`,\n            userId,\n            date: addDays(today, -5),\n            value: 4,\n            createdAt: new Date()\n          }, {\n            id: 'e11',\n            habitId: `mock-${index}`,\n            userId,\n            date: addDays(today, -2),\n            value: 5,\n            createdAt: new Date()\n          });\n        } else if (habit.name === 'Amelia Time') {\n          entries.push({\n            id: 'e12',\n            habitId: `mock-${index}`,\n            userId,\n            date: addDays(today, -6),\n            value: 1,\n            createdAt: new Date()\n          }, {\n            id: 'e13',\n            habitId: `mock-${index}`,\n            userId,\n            date: addDays(today, -4),\n            value: 1,\n            createdAt: new Date()\n          }, {\n            id: 'e14',\n            habitId: `mock-${index}`,\n            userId,\n            date: addDays(today, -3),\n            value: 0.5,\n            createdAt: new Date()\n          });\n        }\n        const currentWeekCount = entries.reduce((sum, e) => sum + e.value, 0);\n        let status = 'pending';\n        if (currentWeekCount >= habit.targetPerWeek) {\n          status = 'met';\n        } else if (habit.name === 'Physical Mobility' || habit.name === 'Cult Meditate') {\n          status = 'today';\n        } else if (habit.name === 'Heavy Clubs 3x10') {\n          status = 'overdue';\n        }\n        return {\n          id: `mock-${index}`,\n          name: habit.name,\n          category: habit.category,\n          targetPerWeek: habit.targetPerWeek,\n          userId: userId,\n          createdAt: new Date(),\n          updatedAt: new Date(),\n          status,\n          currentWeekCount,\n          entries\n        };\n      });\n\n      // Deduplicate habits by name\n      const uniqueHabits = mockHabits.reduce((acc, habit) => {\n        if (!acc.find(h => h.name === habit.name)) {\n          acc.push(habit);\n        }\n        return acc;\n      }, []);\n      console.log('Mock mode: Setting', uniqueHabits.length, 'unique habits (from', mockHabits.length, 'total)');\n      setHabits(uniqueHabits);\n\n      // Group by category with unique habits\n      const categorySections = Object.keys(CATEGORIES).map(cat => {\n        const categoryHabits = uniqueHabits.filter(h => h.category === cat);\n        console.log(`Category ${cat}: ${categoryHabits.length} habits`);\n        return {\n          category: cat,\n          name: CATEGORIES[cat].name,\n          color: CATEGORIES[cat].color,\n          habits: categoryHabits,\n          isCollapsed: collapsedSectionsRef.current.has(cat)\n        };\n      });\n      setSections(categorySections);\n\n      // Set sample stats\n      setSummaryStats({\n        dueToday: 2,\n        overdue: 1,\n        doneToday: 0,\n        onTrack: 0\n      });\n\n      // Mark as loaded\n      setIsLoading(false);\n      return;\n    }\n\n    // Function to fetch and update habits with their status\n    const updateHabitsWithStatus = async () => {\n      try {\n        setIsLoading(true);\n        const habitsWithStatus = await habitService.getHabitsWithStatus(userId);\n\n        // Deduplicate habits by name (keeping the one with most entries)\n        const uniqueHabits = habitsWithStatus.reduce((acc, habit) => {\n          const existing = acc.find(h => h.name === habit.name);\n          if (!existing) {\n            acc.push(habit);\n          } else if (habit.entries.length > existing.entries.length) {\n            // Replace with the one that has more entries\n            const index = acc.indexOf(existing);\n            acc[index] = habit;\n          }\n          return acc;\n        }, []);\n        if (uniqueHabits.length < habitsWithStatus.length) {\n          console.log(`Removed ${habitsWithStatus.length - uniqueHabits.length} duplicate habits`);\n        }\n        setHabits(uniqueHabits);\n\n        // Check if user has no habits and show initializer\n        if (uniqueHabits.length === 0 && !showInitializer) {\n          setShowInitializer(true);\n        }\n\n        // Group by category\n        const categorySections = Object.keys(CATEGORIES).map(cat => ({\n          category: cat,\n          name: CATEGORIES[cat].name,\n          color: CATEGORIES[cat].color,\n          habits: uniqueHabits.filter(h => h.category === cat),\n          isCollapsed: collapsedSectionsRef.current.has(cat)\n        }));\n        setSections(categorySections);\n\n        // Calculate summary stats\n        const stats = {\n          dueToday: uniqueHabits.filter(h => h.status === 'today').length,\n          overdue: uniqueHabits.filter(h => h.status === 'overdue').length,\n          doneToday: uniqueHabits.filter(h => h.status === 'done').length,\n          onTrack: uniqueHabits.filter(h => h.status === 'met').length\n        };\n        setSummaryStats(stats);\n        setIsLoading(false);\n      } catch (error) {\n        console.error('Error fetching habits:', error);\n        // Set defaults on error\n        setSections(Object.keys(CATEGORIES).map(cat => ({\n          category: cat,\n          name: CATEGORIES[cat].name,\n          color: CATEGORIES[cat].color,\n          habits: [],\n          isCollapsed: cat === 'balance' || cat === 'joy'\n        })));\n        setSummaryStats({\n          dueToday: 0,\n          overdue: 0,\n          doneToday: 0,\n          onTrack: 0\n        });\n        setIsLoading(false);\n      }\n    };\n\n    // Subscribe to habits changes\n    const unsubscribeHabits = habitService.subscribeToHabits(userId, () => {\n      updateHabitsWithStatus();\n    });\n\n    // Subscribe to entries changes for the trailing 7 days\n    const endDate = new Date();\n    endDate.setHours(23, 59, 59, 999);\n    const startDate = new Date();\n    startDate.setDate(startDate.getDate() - 6);\n    startDate.setHours(0, 0, 0, 0);\n    const unsubscribeEntries = habitService.subscribeToWeekEntries(userId, startDate, endDate, () => {\n      updateHabitsWithStatus();\n    });\n\n    // Initial load\n    updateHabitsWithStatus();\n    return () => {\n      if (!useMockMode) {\n        unsubscribeHabits();\n        unsubscribeEntries();\n      }\n    };\n  }, [userId, useMockMode]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  const toggleSection = category => {\n    if (collapsedSectionsRef.current.has(category)) {\n      collapsedSectionsRef.current.delete(category);\n    } else {\n      collapsedSectionsRef.current.add(category);\n    }\n    setSections(prev => prev.map(s => s.category === category ? {\n      ...s,\n      isCollapsed: !s.isCollapsed\n    } : s));\n  };\n  const expandAll = () => {\n    collapsedSectionsRef.current.clear();\n    setSections(prev => prev.map(s => ({\n      ...s,\n      isCollapsed: false\n    })));\n  };\n  const collapseAll = () => {\n    Object.keys(CATEGORIES).forEach(cat => collapsedSectionsRef.current.add(cat));\n    setSections(prev => prev.map(s => ({\n      ...s,\n      isCollapsed: true\n    })));\n  };\n  const handleCellClick = async (habitId, date) => {\n    // Check if date is older than yesterday and confirm\n    if (!isToday(date) && !isYesterday(date)) {\n      const dateStr = format(date, 'MMM d');\n      if (!window.confirm(`Are you sure you want to modify entries for ${dateStr}? This is an older date.`)) {\n        return;\n      }\n    }\n    const habit = habits.find(h => h.id === habitId);\n    if (!habit) {\n      console.error('Habit not found:', habitId);\n      return;\n    }\n    const existingEntry = habit.entries.find(e => format(e.date, 'yyyy-MM-dd') === format(date, 'yyyy-MM-dd'));\n\n    // Handle mock mode updates locally\n    if (useMockMode) {\n      // Update local state for mock mode\n      const updatedHabits = habits.map(h => {\n        if (h.id !== habitId) return h;\n        let newEntries = [...h.entries];\n        if (existingEntry) {\n          // Cycle through values: number -> number+1 -> 0.5 -> 0 (remove)\n          if (existingEntry.value >= 1) {\n            if (existingEntry.value < 5) {\n              newEntries = newEntries.map(e => e.id === existingEntry.id ? {\n                ...e,\n                value: existingEntry.value + 1\n              } : e);\n            } else {\n              newEntries = newEntries.map(e => e.id === existingEntry.id ? {\n                ...e,\n                value: 0.5\n              } : e);\n            }\n          } else if (existingEntry.value === 0.5) {\n            newEntries = newEntries.filter(e => e.id !== existingEntry.id);\n          }\n        } else {\n          // Add new entry\n          newEntries.push({\n            id: `new-${Date.now()}`,\n            habitId,\n            userId,\n            date,\n            value: 1,\n            createdAt: new Date()\n          });\n        }\n        const currentWeekCount = newEntries.reduce((sum, e) => sum + e.value, 0);\n        let status = h.status;\n        if (currentWeekCount >= h.targetPerWeek) {\n          status = 'met';\n        }\n        return {\n          ...h,\n          entries: newEntries,\n          currentWeekCount,\n          status\n        };\n      });\n      setHabits(updatedHabits);\n\n      // Update sections\n      const categorySections = Object.keys(CATEGORIES).map(cat => {\n        var _sections$find;\n        return {\n          category: cat,\n          name: CATEGORIES[cat].name,\n          color: CATEGORIES[cat].color,\n          habits: updatedHabits.filter(h => h.category === cat),\n          isCollapsed: ((_sections$find = sections.find(s => s.category === cat)) === null || _sections$find === void 0 ? void 0 : _sections$find.isCollapsed) || false\n        };\n      });\n      setSections(categorySections);\n\n      // Update stats\n      setSummaryStats({\n        dueToday: updatedHabits.filter(h => h.status === 'today').length,\n        overdue: updatedHabits.filter(h => h.status === 'overdue').length,\n        doneToday: updatedHabits.filter(h => h.status === 'done').length,\n        onTrack: updatedHabits.filter(h => h.status === 'met').length\n      });\n      return;\n    }\n\n    // Firebase mode - handle cycling through values\n    console.log('Handling click for habit:', habit.name, 'on date:', format(date, 'yyyy-MM-dd'));\n    console.log('Existing entry:', existingEntry);\n    try {\n      if (existingEntry) {\n        // Cycle through values: 1 -> 2 -> 3 -> 4 -> 5 -> 0.5 -> delete\n        console.log('Updating existing entry with value:', existingEntry.value);\n        if (existingEntry.value >= 1 && existingEntry.value < 5) {\n          await habitService.updateEntry(existingEntry.id, existingEntry.value + 1);\n          console.log('Updated to:', existingEntry.value + 1);\n        } else if (existingEntry.value >= 5) {\n          await habitService.updateEntry(existingEntry.id, 0.5);\n          console.log('Updated to: 0.5');\n        } else if (existingEntry.value === 0.5) {\n          await habitService.deleteEntry(existingEntry.id);\n          console.log('Deleted entry');\n        }\n      } else {\n        // Create new entry with value 1\n        console.log('Creating new entry for habit:', habitId);\n        const entryId = await habitService.addEntry({\n          habitId,\n          userId,\n          date,\n          value: 1\n        });\n        console.log('Created entry with id:', entryId);\n      }\n    } catch (error) {\n      console.error('Error updating entry:', error);\n    }\n  };\n  const getStatusIcon = status => {\n    switch (status) {\n      case 'done':\n        return '●';\n      case 'met':\n        return '✓';\n      case 'today':\n        return '⏰';\n      case 'tomorrow':\n        return '→';\n      case 'overdue':\n        return '!';\n      default:\n        return '';\n    }\n  };\n  const getCellContent = (habit, date) => {\n    const entry = habit.entries.find(e => format(e.date, 'yyyy-MM-dd') === format(date, 'yyyy-MM-dd'));\n    if (!entry) return '';\n    if (entry.value === 1) return '✓';\n    if (entry.value === 0.5) return '½';\n    return entry.value > 1 ? entry.value.toString() : '';\n  };\n  const getCellClass = (habit, date) => {\n    const entry = habit.entries.find(e => format(e.date, 'yyyy-MM-dd') === format(date, 'yyyy-MM-dd'));\n    if (!entry) return '';\n    if (entry.value >= 1) return 'completed';\n    if (entry.value === 0.5) return 'partial';\n    return '';\n  };\n\n  // Show loading screen\n  if (isLoading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      style: {\n        display: 'flex',\n        flexDirection: 'column',\n        justifyContent: 'center',\n        alignItems: 'center',\n        minHeight: '400px',\n        gap: '20px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          fontSize: '48px',\n          animation: 'pulse 1.5s ease-in-out infinite'\n        },\n        children: \"\\u23F3\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 437,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          fontSize: '18px',\n          color: '#94a3b8'\n        },\n        children: \"Loading your habits...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 438,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          fontSize: '14px',\n          color: '#64748b'\n        },\n        children: \"Setting up your tracking dashboard\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 439,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 429,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"week-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"week-title\",\n        children: [\"Last 7 Days \\u2022\", /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"current-day\",\n          children: format(new Date(), 'EEEE, MMM d')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 449,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 447,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"view-toggle\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"toggle-btn\",\n          onClick: expandAll,\n          children: \"Expand All\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 452,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"toggle-btn\",\n          onClick: collapseAll,\n          children: \"Collapse All\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 453,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"toggle-btn active\",\n          children: \"Dense View\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 454,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"toggle-btn add-habit\",\n          onClick: () => setShowHabitManager(true),\n          children: \"+ Add Habit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 455,\n          columnNumber: 11\n        }, this), habits.length === 0 && /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"toggle-btn initialize\",\n          onClick: () => setShowInitializer(true),\n          children: \"\\uD83D\\uDCE5 Load Default Habits\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 459,\n          columnNumber: 13\n        }, this), !useMockMode && habits.length > 0 && /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"toggle-btn cleanup\",\n          onClick: () => setShowCleanup(true),\n          style: {\n            background: '#dc2626',\n            marginLeft: '8px'\n          },\n          children: \"\\uD83E\\uDDF9 Clean Duplicates\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 464,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 451,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 446,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"summary-bar\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"summary-item\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"summary-label\",\n          children: \"Due Today:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 474,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"summary-value value-today\",\n          children: summaryStats.dueToday\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 475,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 473,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"summary-item\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"summary-label\",\n          children: \"Overdue:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 478,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"summary-value value-overdue\",\n          children: summaryStats.overdue\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 479,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 477,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"summary-item\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"summary-label\",\n          children: \"Done Today:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 482,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"summary-value value-done\",\n          children: summaryStats.doneToday\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 483,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 481,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"summary-item\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"summary-label\",\n          children: \"On Track:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 486,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"summary-value value-track\",\n          children: summaryStats.onTrack\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 487,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 485,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 472,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n      children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n        children: /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"th\", {\n            className: \"col-habit\",\n            children: \"Habit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 494,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            className: \"col-status\",\n            children: \"\\u25CF\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 495,\n            columnNumber: 13\n          }, this), weekDates.map(date => /*#__PURE__*/_jsxDEV(\"th\", {\n            className: \"col-day\",\n            children: [format(date, 'E')[0], /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 498,\n              columnNumber: 39\n            }, this), format(date, 'd')]\n          }, date.toISOString(), true, {\n            fileName: _jsxFileName,\n            lineNumber: 497,\n            columnNumber: 15\n          }, this)), /*#__PURE__*/_jsxDEV(\"th\", {\n            className: \"col-total\",\n            children: \"Total\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 502,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 493,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 492,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n        children: sections.map(section => /*#__PURE__*/_jsxDEV(React.Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"tr\", {\n            className: \"section-header\",\n            onClick: () => toggleSection(section.category),\n            children: /*#__PURE__*/_jsxDEV(\"td\", {\n              colSpan: 10,\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  display: 'flex',\n                  justifyContent: 'space-between',\n                  alignItems: 'center'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"section-title\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: `section-arrow ${section.isCollapsed ? 'collapsed' : ''}`,\n                    children: \"\\u25BC\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 512,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"section-indicator\",\n                    style: {\n                      background: section.color\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 513,\n                    columnNumber: 23\n                  }, this), section.name]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 511,\n                  columnNumber: 21\n                }, this), section.isCollapsed && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"section-summary\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"summary-stat\",\n                    children: /*#__PURE__*/_jsxDEV(\"span\", {\n                      className: `stat-value stat-${section.habits.filter(h => h.status === 'met').length > 0 ? 'good' : section.habits.filter(h => h.status === 'today').length > 0 ? 'warn' : 'bad'}`,\n                      children: [section.habits.filter(h => h.status === 'met').length, \" met\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 522,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 521,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"summary-stat\",\n                    children: [section.habits.reduce((sum, h) => sum + h.currentWeekCount, 0), \" total\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 529,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 520,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 510,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 509,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 508,\n            columnNumber: 15\n          }, this), !section.isCollapsed && section.habits.map(habit => /*#__PURE__*/_jsxDEV(\"tr\", {\n            className: \"section-row\",\n            children: [/*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"col-habit\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"habit-name\",\n                children: [habit.name, /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"habit-target\",\n                  children: [\"(\", habit.targetPerWeek, \"/w)\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 542,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 540,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 539,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: /*#__PURE__*/_jsxDEV(\"span\", {\n                className: `status status-${habit.status}`,\n                children: getStatusIcon(habit.status)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 546,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 545,\n              columnNumber: 19\n            }, this), weekDates.map(date => /*#__PURE__*/_jsxDEV(\"td\", {\n              className: getCellClass(habit, date),\n              onClick: () => handleCellClick(habit.id, date),\n              style: {\n                cursor: 'pointer'\n              },\n              children: getCellContent(habit, date)\n            }, date.toISOString(), false, {\n              fileName: _jsxFileName,\n              lineNumber: 551,\n              columnNumber: 21\n            }, this)), /*#__PURE__*/_jsxDEV(\"td\", {\n              className: `total total-${habit.currentWeekCount >= habit.targetPerWeek ? 'good' : habit.currentWeekCount > 0 ? 'warn' : 'bad'}`,\n              children: [habit.currentWeekCount, \"/\", habit.targetPerWeek]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 560,\n              columnNumber: 19\n            }, this)]\n          }, habit.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 538,\n            columnNumber: 17\n          }, this))]\n        }, section.category, true, {\n          fileName: _jsxFileName,\n          lineNumber: 507,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 505,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 491,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"legend-strip\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"legend-item\",\n        children: \"\\u25CF = done\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 574,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"legend-item\",\n        children: \"\\u2713 = met target\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 575,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"legend-item\",\n        children: \"\\u23F0 = due today\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 576,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"legend-item\",\n        children: \"\\u2192 = tomorrow\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 577,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"legend-item\",\n        children: \"! = overdue\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 578,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"legend-item\",\n        children: \"\\xBD = partial\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 579,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 573,\n      columnNumber: 7\n    }, this), showHabitManager && /*#__PURE__*/_jsxDEV(HabitManager, {\n      userId: userId,\n      onClose: () => setShowHabitManager(false)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 583,\n      columnNumber: 9\n    }, this), showInitializer && /*#__PURE__*/_jsxDEV(InitializeHabits, {\n      userId: userId,\n      onComplete: () => setShowInitializer(false)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 590,\n      columnNumber: 9\n    }, this), showCleanup && /*#__PURE__*/_jsxDEV(CleanupDuplicates, {\n      userId: userId,\n      onComplete: () => {\n        setShowCleanup(false);\n        // Force refresh after cleanup\n        window.location.reload();\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 597,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 445,\n    columnNumber: 5\n  }, this);\n};\n_s(HabitTracker, \"Hb44F0hLoH2LoVAdVvDdV8Kb9Ww=\");\n_c = HabitTracker;\nvar _c;\n$RefreshReg$(_c, \"HabitTracker\");","map":{"version":3,"names":["React","useState","useEffect","useRef","HabitService","HabitManager","InitializeHabits","CleanupDuplicates","DEFAULT_HABITS","format","addDays","isYesterday","isToday","jsxDEV","_jsxDEV","habitService","CATEGORIES","mobility","name","color","connection","balance","joy","strength","HabitTracker","userId","_s","habits","setHabits","sections","setSections","weekDates","setWeekDates","showHabitManager","setShowHabitManager","showInitializer","setShowInitializer","showCleanup","setShowCleanup","isLoading","setIsLoading","collapsedSectionsRef","Set","useMockMode","summaryStats","setSummaryStats","dueToday","overdue","doneToday","onTrack","today","Date","dates","i","push","mockHabits","map","habit","index","entries","id","habitId","date","value","createdAt","currentWeekCount","reduce","sum","e","status","targetPerWeek","category","updatedAt","uniqueHabits","acc","find","h","console","log","length","categorySections","Object","keys","cat","categoryHabits","filter","isCollapsed","current","has","updateHabitsWithStatus","habitsWithStatus","getHabitsWithStatus","existing","indexOf","stats","error","unsubscribeHabits","subscribeToHabits","endDate","setHours","startDate","setDate","getDate","unsubscribeEntries","subscribeToWeekEntries","toggleSection","delete","add","prev","s","expandAll","clear","collapseAll","forEach","handleCellClick","dateStr","window","confirm","existingEntry","updatedHabits","newEntries","now","_sections$find","updateEntry","deleteEntry","entryId","addEntry","getStatusIcon","getCellContent","entry","toString","getCellClass","className","style","display","flexDirection","justifyContent","alignItems","minHeight","gap","children","fontSize","animation","fileName","_jsxFileName","lineNumber","columnNumber","onClick","background","marginLeft","toISOString","section","Fragment","colSpan","cursor","onClose","onComplete","location","reload","_c","$RefreshReg$"],"sources":["/Users/idvorkin/gits/humane-tracker-1/humane-tracker/src/components/HabitTracker.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { HabitWithStatus, CategorySection, SummaryStats } from '../types/habit';\nimport { HabitService } from '../services/habitService';\nimport { HabitManager } from './HabitManager';\nimport { InitializeHabits } from './InitializeHabits';\nimport { CleanupDuplicates } from './CleanupDuplicates';\nimport { DEFAULT_HABITS } from '../data/defaultHabits';\nimport { format, addDays, isYesterday, isToday } from 'date-fns';\nimport './HabitTracker.css';\n\nconst habitService = new HabitService();\n\nconst CATEGORIES: { [key: string]: { name: string; color: string } } = {\n  mobility: { name: 'Movement & Mobility', color: '#60a5fa' },\n  connection: { name: 'Connections', color: '#a855f7' },\n  balance: { name: 'Inner Balance', color: '#fbbf24' },\n  joy: { name: 'Joy & Play', color: '#f472b6' },\n  strength: { name: 'Strength Building', color: '#34d399' }\n};\n\nexport const HabitTracker: React.FC<{ userId: string }> = ({ userId }) => {\n  const [habits, setHabits] = useState<HabitWithStatus[]>([]);\n  const [sections, setSections] = useState<CategorySection[]>([]);\n  const [weekDates, setWeekDates] = useState<Date[]>([]);\n  const [showHabitManager, setShowHabitManager] = useState(false);\n  const [showInitializer, setShowInitializer] = useState(false);\n  const [showCleanup, setShowCleanup] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  const collapsedSectionsRef = useRef<Set<string>>(new Set(['balance', 'joy']));\n  const useMockMode = !userId || userId === 'mock-user';\n  const [summaryStats, setSummaryStats] = useState<SummaryStats>({\n    dueToday: 0,\n    overdue: 0,\n    doneToday: 0,\n    onTrack: 0\n  });\n\n  useEffect(() => {\n    // Reset state when mode changes\n    setHabits([]);\n    setSections([]);\n    \n    // Set up trailing 7 days (today and previous 6 days)\n    const today = new Date();\n    const dates = [];\n    for (let i = 6; i >= 0; i--) {\n      dates.push(addDays(today, -i));\n    }\n    setWeekDates(dates);\n\n    // Check if we should use mock mode\n    if (useMockMode) {\n      // Use mock data for testing with default habits and some sample entries  \n      const today = new Date();\n      const mockHabits: HabitWithStatus[] = DEFAULT_HABITS.map((habit, index) => {\n        // Add some sample entries for demo\n        const entries = [];\n        \n        // Add sample entries for some habits\n        if (habit.name === 'Back Twists') {\n          entries.push(\n            { id: 'e1', habitId: `mock-${index}`, userId, date: addDays(today, -6), value: 2, createdAt: new Date() },\n            { id: 'e2', habitId: `mock-${index}`, userId, date: addDays(today, -5), value: 4, createdAt: new Date() },\n            { id: 'e3', habitId: `mock-${index}`, userId, date: addDays(today, -4), value: 4, createdAt: new Date() },\n            { id: 'e4', habitId: `mock-${index}`, userId, date: addDays(today, -3), value: 4, createdAt: new Date() }\n          );\n        } else if (habit.name === 'Shin Boxes') {\n          entries.push(\n            { id: 'e5', habitId: `mock-${index}`, userId, date: addDays(today, -6), value: 2, createdAt: new Date() },\n            { id: 'e6', habitId: `mock-${index}`, userId, date: addDays(today, -4), value: 1, createdAt: new Date() },\n            { id: 'e7', habitId: `mock-${index}`, userId, date: addDays(today, -2), value: 1, createdAt: new Date() }\n          );\n        } else if (habit.name === 'Juggling') {\n          entries.push(\n            { id: 'e8', habitId: `mock-${index}`, userId, date: addDays(today, -6), value: 3, createdAt: new Date() },\n            { id: 'e9', habitId: `mock-${index}`, userId, date: addDays(today, -3), value: 1, createdAt: new Date() }\n          );\n        } else if (habit.name === 'TGU 28KG') {\n          entries.push(\n            { id: 'e10', habitId: `mock-${index}`, userId, date: addDays(today, -5), value: 4, createdAt: new Date() },\n            { id: 'e11', habitId: `mock-${index}`, userId, date: addDays(today, -2), value: 5, createdAt: new Date() }\n          );\n        } else if (habit.name === 'Amelia Time') {\n          entries.push(\n            { id: 'e12', habitId: `mock-${index}`, userId, date: addDays(today, -6), value: 1, createdAt: new Date() },\n            { id: 'e13', habitId: `mock-${index}`, userId, date: addDays(today, -4), value: 1, createdAt: new Date() },\n            { id: 'e14', habitId: `mock-${index}`, userId, date: addDays(today, -3), value: 0.5, createdAt: new Date() }\n          );\n        }\n        \n        const currentWeekCount = entries.reduce((sum, e) => sum + e.value, 0);\n        let status: any = 'pending';\n        \n        if (currentWeekCount >= habit.targetPerWeek) {\n          status = 'met';\n        } else if (habit.name === 'Physical Mobility' || habit.name === 'Cult Meditate') {\n          status = 'today';\n        } else if (habit.name === 'Heavy Clubs 3x10') {\n          status = 'overdue';\n        }\n        \n        return {\n          id: `mock-${index}`,\n          name: habit.name,\n          category: habit.category,\n          targetPerWeek: habit.targetPerWeek,\n          userId: userId,\n          createdAt: new Date(),\n          updatedAt: new Date(),\n          status,\n          currentWeekCount,\n          entries\n        };\n      });\n      \n      // Deduplicate habits by name\n      const uniqueHabits = mockHabits.reduce((acc, habit) => {\n        if (!acc.find(h => h.name === habit.name)) {\n          acc.push(habit);\n        }\n        return acc;\n      }, [] as HabitWithStatus[]);\n      \n      console.log('Mock mode: Setting', uniqueHabits.length, 'unique habits (from', mockHabits.length, 'total)');\n      \n      setHabits(uniqueHabits);\n      \n      // Group by category with unique habits\n      const categorySections: CategorySection[] = Object.keys(CATEGORIES).map(cat => {\n        const categoryHabits = uniqueHabits.filter(h => h.category === cat);\n        console.log(`Category ${cat}: ${categoryHabits.length} habits`);\n        return {\n          category: cat as any,\n          name: CATEGORIES[cat].name,\n          color: CATEGORIES[cat].color,\n          habits: categoryHabits,\n          isCollapsed: collapsedSectionsRef.current.has(cat)\n        };\n      });\n      setSections(categorySections);\n      \n      // Set sample stats\n      setSummaryStats({\n        dueToday: 2,\n        overdue: 1,\n        doneToday: 0,\n        onTrack: 0\n      });\n      \n      // Mark as loaded\n      setIsLoading(false);\n      \n      return;\n    }\n\n    // Function to fetch and update habits with their status\n    const updateHabitsWithStatus = async () => {\n      try {\n        setIsLoading(true);\n        const habitsWithStatus = await habitService.getHabitsWithStatus(userId);\n        \n        // Deduplicate habits by name (keeping the one with most entries)\n        const uniqueHabits = habitsWithStatus.reduce((acc, habit) => {\n          const existing = acc.find(h => h.name === habit.name);\n          if (!existing) {\n            acc.push(habit);\n          } else if (habit.entries.length > existing.entries.length) {\n            // Replace with the one that has more entries\n            const index = acc.indexOf(existing);\n            acc[index] = habit;\n          }\n          return acc;\n        }, [] as HabitWithStatus[]);\n        \n        if (uniqueHabits.length < habitsWithStatus.length) {\n          console.log(`Removed ${habitsWithStatus.length - uniqueHabits.length} duplicate habits`);\n        }\n        \n        setHabits(uniqueHabits);\n        \n        // Check if user has no habits and show initializer\n        if (uniqueHabits.length === 0 && !showInitializer) {\n          setShowInitializer(true);\n        }\n        \n        // Group by category\n        const categorySections: CategorySection[] = Object.keys(CATEGORIES).map(cat => ({\n          category: cat as any,\n          name: CATEGORIES[cat].name,\n          color: CATEGORIES[cat].color,\n          habits: uniqueHabits.filter(h => h.category === cat),\n          isCollapsed: collapsedSectionsRef.current.has(cat)\n        }));\n        setSections(categorySections);\n        \n        // Calculate summary stats\n        const stats: SummaryStats = {\n          dueToday: uniqueHabits.filter(h => h.status === 'today').length,\n          overdue: uniqueHabits.filter(h => h.status === 'overdue').length,\n          doneToday: uniqueHabits.filter(h => h.status === 'done').length,\n          onTrack: uniqueHabits.filter(h => h.status === 'met').length\n        };\n        setSummaryStats(stats);\n        setIsLoading(false);\n      } catch (error) {\n        console.error('Error fetching habits:', error);\n        // Set defaults on error\n        setSections(Object.keys(CATEGORIES).map(cat => ({\n          category: cat as any,\n          name: CATEGORIES[cat].name,\n          color: CATEGORIES[cat].color,\n          habits: [],\n          isCollapsed: cat === 'balance' || cat === 'joy'\n        })));\n        setSummaryStats({\n          dueToday: 0,\n          overdue: 0,\n          doneToday: 0,\n          onTrack: 0\n        });\n        setIsLoading(false);\n      }\n    };\n\n    // Subscribe to habits changes\n    const unsubscribeHabits = habitService.subscribeToHabits(userId, () => {\n      updateHabitsWithStatus();\n    });\n\n    // Subscribe to entries changes for the trailing 7 days\n    const endDate = new Date();\n    endDate.setHours(23, 59, 59, 999);\n    const startDate = new Date();\n    startDate.setDate(startDate.getDate() - 6);\n    startDate.setHours(0, 0, 0, 0);\n    \n    const unsubscribeEntries = habitService.subscribeToWeekEntries(userId, startDate, endDate, () => {\n      updateHabitsWithStatus();\n    });\n\n    // Initial load\n    updateHabitsWithStatus();\n\n    return () => {\n      if (!useMockMode) {\n        unsubscribeHabits();\n        unsubscribeEntries();\n      }\n    };\n  }, [userId, useMockMode]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  const toggleSection = (category: string) => {\n    if (collapsedSectionsRef.current.has(category)) {\n      collapsedSectionsRef.current.delete(category);\n    } else {\n      collapsedSectionsRef.current.add(category);\n    }\n    setSections(prev => prev.map(s => \n      s.category === category ? { ...s, isCollapsed: !s.isCollapsed } : s\n    ));\n  };\n\n  const expandAll = () => {\n    collapsedSectionsRef.current.clear();\n    setSections(prev => prev.map(s => ({ ...s, isCollapsed: false })));\n  };\n\n  const collapseAll = () => {\n    Object.keys(CATEGORIES).forEach(cat => collapsedSectionsRef.current.add(cat));\n    setSections(prev => prev.map(s => ({ ...s, isCollapsed: true })));\n  };\n\n  const handleCellClick = async (habitId: string, date: Date) => {\n    // Check if date is older than yesterday and confirm\n    if (!isToday(date) && !isYesterday(date)) {\n      const dateStr = format(date, 'MMM d');\n      if (!window.confirm(`Are you sure you want to modify entries for ${dateStr}? This is an older date.`)) {\n        return;\n      }\n    }\n    \n    const habit = habits.find(h => h.id === habitId);\n    if (!habit) {\n      console.error('Habit not found:', habitId);\n      return;\n    }\n    \n    const existingEntry = habit.entries.find(e => \n      format(e.date, 'yyyy-MM-dd') === format(date, 'yyyy-MM-dd')\n    );\n    \n    // Handle mock mode updates locally\n    if (useMockMode) {\n      // Update local state for mock mode\n      const updatedHabits = habits.map(h => {\n        if (h.id !== habitId) return h;\n        \n        let newEntries = [...h.entries];\n        \n        if (existingEntry) {\n          // Cycle through values: number -> number+1 -> 0.5 -> 0 (remove)\n          if (existingEntry.value >= 1) {\n            if (existingEntry.value < 5) {\n              newEntries = newEntries.map(e => \n                e.id === existingEntry.id ? { ...e, value: existingEntry.value + 1 } : e\n              );\n            } else {\n              newEntries = newEntries.map(e => \n                e.id === existingEntry.id ? { ...e, value: 0.5 } : e\n              );\n            }\n          } else if (existingEntry.value === 0.5) {\n            newEntries = newEntries.filter(e => e.id !== existingEntry.id);\n          }\n        } else {\n          // Add new entry\n          newEntries.push({\n            id: `new-${Date.now()}`,\n            habitId,\n            userId,\n            date,\n            value: 1,\n            createdAt: new Date()\n          } as any);\n        }\n        \n        const currentWeekCount = newEntries.reduce((sum, e) => sum + e.value, 0);\n        let status = h.status;\n        if (currentWeekCount >= h.targetPerWeek) {\n          status = 'met';\n        }\n        \n        return { ...h, entries: newEntries, currentWeekCount, status };\n      });\n      \n      setHabits(updatedHabits);\n      \n      // Update sections\n      const categorySections: CategorySection[] = Object.keys(CATEGORIES).map(cat => ({\n        category: cat as any,\n        name: CATEGORIES[cat].name,\n        color: CATEGORIES[cat].color,\n        habits: updatedHabits.filter(h => h.category === cat),\n        isCollapsed: sections.find(s => s.category === cat)?.isCollapsed || false\n      }));\n      setSections(categorySections);\n      \n      // Update stats\n      setSummaryStats({\n        dueToday: updatedHabits.filter(h => h.status === 'today').length,\n        overdue: updatedHabits.filter(h => h.status === 'overdue').length,\n        doneToday: updatedHabits.filter(h => h.status === 'done').length,\n        onTrack: updatedHabits.filter(h => h.status === 'met').length\n      });\n      \n      return;\n    }\n    \n    // Firebase mode - handle cycling through values\n    console.log('Handling click for habit:', habit.name, 'on date:', format(date, 'yyyy-MM-dd'));\n    console.log('Existing entry:', existingEntry);\n    \n    try {\n      if (existingEntry) {\n        // Cycle through values: 1 -> 2 -> 3 -> 4 -> 5 -> 0.5 -> delete\n        console.log('Updating existing entry with value:', existingEntry.value);\n        if (existingEntry.value >= 1 && existingEntry.value < 5) {\n          await habitService.updateEntry(existingEntry.id, existingEntry.value + 1);\n          console.log('Updated to:', existingEntry.value + 1);\n        } else if (existingEntry.value >= 5) {\n          await habitService.updateEntry(existingEntry.id, 0.5);\n          console.log('Updated to: 0.5');\n        } else if (existingEntry.value === 0.5) {\n          await habitService.deleteEntry(existingEntry.id);\n          console.log('Deleted entry');\n        }\n      } else {\n        // Create new entry with value 1\n        console.log('Creating new entry for habit:', habitId);\n        const entryId = await habitService.addEntry({\n          habitId,\n          userId,\n          date,\n          value: 1\n        });\n        console.log('Created entry with id:', entryId);\n      }\n    } catch (error) {\n      console.error('Error updating entry:', error);\n    }\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'done': return '●';\n      case 'met': return '✓';\n      case 'today': return '⏰';\n      case 'tomorrow': return '→';\n      case 'overdue': return '!';\n      default: return '';\n    }\n  };\n\n  const getCellContent = (habit: HabitWithStatus, date: Date) => {\n    const entry = habit.entries.find(e => \n      format(e.date, 'yyyy-MM-dd') === format(date, 'yyyy-MM-dd')\n    );\n    \n    if (!entry) return '';\n    if (entry.value === 1) return '✓';\n    if (entry.value === 0.5) return '½';\n    return entry.value > 1 ? entry.value.toString() : '';\n  };\n\n  const getCellClass = (habit: HabitWithStatus, date: Date) => {\n    const entry = habit.entries.find(e => \n      format(e.date, 'yyyy-MM-dd') === format(date, 'yyyy-MM-dd')\n    );\n    \n    if (!entry) return '';\n    if (entry.value >= 1) return 'completed';\n    if (entry.value === 0.5) return 'partial';\n    return '';\n  };\n\n  // Show loading screen\n  if (isLoading) {\n    return (\n      <div className=\"container\" style={{ \n        display: 'flex', \n        flexDirection: 'column',\n        justifyContent: 'center', \n        alignItems: 'center', \n        minHeight: '400px',\n        gap: '20px'\n      }}>\n        <div style={{ fontSize: '48px', animation: 'pulse 1.5s ease-in-out infinite' }}>⏳</div>\n        <div style={{ fontSize: '18px', color: '#94a3b8' }}>Loading your habits...</div>\n        <div style={{ fontSize: '14px', color: '#64748b' }}>Setting up your tracking dashboard</div>\n      </div>\n    );\n  }\n  \n  return (\n    <div className=\"container\">\n      <div className=\"week-header\">\n        <div className=\"week-title\">\n          Last 7 Days • \n          <span className=\"current-day\">{format(new Date(), 'EEEE, MMM d')}</span>\n        </div>\n        <div className=\"view-toggle\">\n          <button className=\"toggle-btn\" onClick={expandAll}>Expand All</button>\n          <button className=\"toggle-btn\" onClick={collapseAll}>Collapse All</button>\n          <button className=\"toggle-btn active\">Dense View</button>\n          <button className=\"toggle-btn add-habit\" onClick={() => setShowHabitManager(true)}>\n            + Add Habit\n          </button>\n          {habits.length === 0 && (\n            <button className=\"toggle-btn initialize\" onClick={() => setShowInitializer(true)}>\n              📥 Load Default Habits\n            </button>\n          )}\n          {!useMockMode && habits.length > 0 && (\n            <button className=\"toggle-btn cleanup\" onClick={() => setShowCleanup(true)}\n              style={{ background: '#dc2626', marginLeft: '8px' }}>\n              🧹 Clean Duplicates\n            </button>\n          )}\n        </div>\n      </div>\n\n      <div className=\"summary-bar\">\n        <div className=\"summary-item\">\n          <span className=\"summary-label\">Due Today:</span>\n          <span className=\"summary-value value-today\">{summaryStats.dueToday}</span>\n        </div>\n        <div className=\"summary-item\">\n          <span className=\"summary-label\">Overdue:</span>\n          <span className=\"summary-value value-overdue\">{summaryStats.overdue}</span>\n        </div>\n        <div className=\"summary-item\">\n          <span className=\"summary-label\">Done Today:</span>\n          <span className=\"summary-value value-done\">{summaryStats.doneToday}</span>\n        </div>\n        <div className=\"summary-item\">\n          <span className=\"summary-label\">On Track:</span>\n          <span className=\"summary-value value-track\">{summaryStats.onTrack}</span>\n        </div>\n      </div>\n\n      <table>\n        <thead>\n          <tr>\n            <th className=\"col-habit\">Habit</th>\n            <th className=\"col-status\">●</th>\n            {weekDates.map(date => (\n              <th key={date.toISOString()} className=\"col-day\">\n                {format(date, 'E')[0]}<br/>\n                {format(date, 'd')}\n              </th>\n            ))}\n            <th className=\"col-total\">Total</th>\n          </tr>\n        </thead>\n        <tbody>\n          {sections.map(section => (\n            <React.Fragment key={section.category}>\n              <tr className=\"section-header\" onClick={() => toggleSection(section.category)}>\n                <td colSpan={10}>\n                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n                    <div className=\"section-title\">\n                      <span className={`section-arrow ${section.isCollapsed ? 'collapsed' : ''}`}>▼</span>\n                      <span \n                        className=\"section-indicator\" \n                        style={{ background: section.color }}\n                      />\n                      {section.name}\n                    </div>\n                    {section.isCollapsed && (\n                      <div className=\"section-summary\">\n                        <span className=\"summary-stat\">\n                          <span className={`stat-value stat-${\n                            section.habits.filter(h => h.status === 'met').length > 0 ? 'good' :\n                            section.habits.filter(h => h.status === 'today').length > 0 ? 'warn' : 'bad'\n                          }`}>\n                            {section.habits.filter(h => h.status === 'met').length} met\n                          </span>\n                        </span>\n                        <span className=\"summary-stat\">\n                          {section.habits.reduce((sum, h) => sum + h.currentWeekCount, 0)} total\n                        </span>\n                      </div>\n                    )}\n                  </div>\n                </td>\n              </tr>\n              {!section.isCollapsed && section.habits.map(habit => (\n                <tr key={habit.id} className=\"section-row\">\n                  <td className=\"col-habit\">\n                    <div className=\"habit-name\">\n                      {habit.name}\n                      <span className=\"habit-target\">({habit.targetPerWeek}/w)</span>\n                    </div>\n                  </td>\n                  <td>\n                    <span className={`status status-${habit.status}`}>\n                      {getStatusIcon(habit.status)}\n                    </span>\n                  </td>\n                  {weekDates.map(date => (\n                    <td \n                      key={date.toISOString()} \n                      className={getCellClass(habit, date)}\n                      onClick={() => handleCellClick(habit.id, date)}\n                      style={{ cursor: 'pointer' }}\n                    >\n                      {getCellContent(habit, date)}\n                    </td>\n                  ))}\n                  <td className={`total total-${\n                    habit.currentWeekCount >= habit.targetPerWeek ? 'good' :\n                    habit.currentWeekCount > 0 ? 'warn' : 'bad'\n                  }`}>\n                    {habit.currentWeekCount}/{habit.targetPerWeek}\n                  </td>\n                </tr>\n              ))}\n            </React.Fragment>\n          ))}\n        </tbody>\n      </table>\n\n      <div className=\"legend-strip\">\n        <div className=\"legend-item\">● = done</div>\n        <div className=\"legend-item\">✓ = met target</div>\n        <div className=\"legend-item\">⏰ = due today</div>\n        <div className=\"legend-item\">→ = tomorrow</div>\n        <div className=\"legend-item\">! = overdue</div>\n        <div className=\"legend-item\">½ = partial</div>\n      </div>\n\n      {showHabitManager && (\n        <HabitManager \n          userId={userId} \n          onClose={() => setShowHabitManager(false)} \n        />\n      )}\n      \n      {showInitializer && (\n        <InitializeHabits \n          userId={userId} \n          onComplete={() => setShowInitializer(false)} \n        />\n      )}\n      \n      {showCleanup && (\n        <CleanupDuplicates \n          userId={userId} \n          onComplete={() => {\n            setShowCleanup(false);\n            // Force refresh after cleanup\n            window.location.reload();\n          }} \n        />\n      )}\n    </div>\n  );\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}